(function(a){window.AF=window.AF||{};AF.Grid=function(e){var B={id:null,dataSource:null,statePersist:a.statePersistToCookie,isGridGroupable:true,isGridSortable:true,groupsPlaceHolder:"."+e.id+"-afGrid-group-by",columnWidthOverride:null,pageSize:null,afGridSelector:"#"+e.id,onRowClick:a.noop,onSort:G,onGroupChange:r,onGroupReorder:y,onFilter:z,onColumnReorder:A,onColumnResize:m,onScrollToBottom:i,onStateChange:a.noop,onReset:c,onRefresh:h,onGridDataLoaded:a.noop,groupBy:[],clientCache:false};
e=a.extend(true,{},B,e);var f=a();var l=new AF.Grid.DataStore(e.dataSource,e.clientCache),w=0,p=0,F=0,g=null,k;function H(I){g=I.columns;p=I.totalRows;w=I.rows.length;F=I.pageSize||e.pageSize;I.columnWidthOverride=I.columnWidthOverride||k.columnWidthOverride;if(I.groupBy&&I.groupBy.length){I.groupBy=a.map(I.groupBy,function(J){return J.id;
});}if(I.sortBy&&I.sortBy.length){I.sortBy={column:I.sortBy[0].id,direction:I.sortBy[0].direction};}t(I);k.columnOrder=a.map(I.columns,function(J){return J.id;});k.hiddenColumns=I.hiddenColumns;C();f.trigger(a.afGrid.hideLoading);}function C(){if(e.statePersist){e.statePersist.save("afGridState_"+e.id,JSON.stringify(k));
}e.onStateChange(k);}function E(I){if(e.statePersist){e.statePersist.load("afGridState_"+e.id,function(J){I(JSON.parse(J));});}else{I({});}}function i(){if(w>=p){return;}var I=a.extend({},k,{pageOffset:w+1,pageSize:F});f.trigger(a.afGrid.showLoading);l.fetchRows(I,n);}function n(I){k=k||{};w+=I.rows.length;
d(I);f.trigger(a.afGrid.hideLoading);}function u(I){k=k||{};k.pageSize=e.pageSize=I.pageSize||k.pageSize;k=a.extend(true,k,I.state);H(I);}function z(I){k.filterBy=I;f.trigger(a.afGrid.showLoading);l.filter(k,H);}function r(I){var J;if(k.columnOrder){J=[];a.each(I,function(K,L){J.push(L);});a.each(k.columnOrder,function(K,L){if(J.indexOf(L)<0){J.push(L);
}});k.columnOrder=J;}k.groupBy=I.length?a.map(I,function(L){var K=j(L).column;return{id:L,type:K.type||K.renderer||null,direction:"desc"};}):[];f.trigger(a.afGrid.showLoading);l.groupBy(k,H);}function G(J,K){var I=j(J).column;k.sortBy=[{id:J,type:I.type||I.renderer||null,direction:K}];f.trigger(a.afGrid.showLoading);
l.sortBy(k,H);}function A(K){var J,M,L,I;if(k.groupBy&&k.groupBy.length){J=k.groupBy.length;M=[];for(L=0;L<J;L+=1){I=j(K[L]);if(I.column.isGroupable){M.push(K[L]);}else{break;}}k.groupBy=a.map(M,function(N){return{id:N,direction:"desc"};});}k.columnOrder=K;f.trigger(a.afGrid.showLoading);l.reorderColumn(k,H);
}function j(J){var K=-1,I=a.grep(g,function(M,L){if(M.id===J){K=L;return true;}return false;})[0];return{column:I,index:K};}function y(I){r(I);}function m(K,I,J){k.columnWidthOverride=k.columnWidthOverride||{};k.columnWidthOverride[K]=J;C();}function o(I){E(function(J){k=I||J||{};if(e.pageSize){k.pageSize=e.pageSize;
}l.load(k,u);});}function D(){f.unbind(a.afGrid.renderingComplete);b();if(l){l.destroy();l=null;}}function h(){f.trigger(a.afGrid.destroy);f.removeClass("afGrid-initialized");if(l){l.refresh(k,u);}}function b(){if(e.statePersist){e.statePersist.save("afGridState_"+e.id,null);}k={};k.pageSize=e.pageSize;
f.trigger(a.afGrid.destroy);f.removeClass("afGrid-initialized");}function c(I){e.groupBy=[];e.state={};e.columnWidthOverride=null;e.sortBy=[];e.filterBy=[];b();k=I||null;if(l){l.refresh(k,u);}}function s(){return e.dataSource;}function v(){return l.getCurrentMetaData();}function t(J){var I=a.extend(e,J);
f=a(e.afGridSelector);f.bind(a.afGrid.renderingComplete,e.onGridDataLoaded);f.afGrid(I);}function d(I){f.trigger(a.afGrid.appendRows,[I.rows,k.columnWidthOverride]);}function q(){return B;}function x(){return a.extend({},e);}return a.extend({},AF.Grid.extension,{load:o,destroy:D,refresh:h,resetAndRefresh:c,getDefaultOptions:q,getCurrentOptions:x,getCurrentMetaData:v,getSource:s});
};AF.Grid.extension={};}(jQuery));(function(f){if(!f.browser){var n=/MSIE(.*?);/.exec(navigator.appVersion);f.browser={msie:navigator&&navigator.appName.indexOf("Microsoft")>-1,version:n&&n[1]};}if(f.browser.msie&&parseInt(f.browser.version.slice(0,1),10)<=7&&document.documentMode!==8){f("html").addClass("ie7below");
}f.afGrid=f.extend(f.afGrid,{appendRows:"afGrid-append-rows",destroy:"afGrid-destroy",renderingComplete:"afGrid-rendering-complete",adjustRowWidth:"afGrid-adjust-row-width",showLoading:"afGrid-showLoading",hideLoading:"afGrid-hideLoading",getElementId:function(H){var G=H.split("_");G.splice(0,1);return G.join("_");
}});f.afGrid.renderer={};f.afGrid.filter={};f.afGrid.plugin=f.afGrid.plugin||{};var y={};var l;var t="<div class='total-row-count'>Showing {loadedRows} of {totalRows}</div>",u="<div class='group-data'></div>",c="<div class='afGrid-heading'></div>",g="<div class='{cssClass} column-helper'></div>",x="<div class='afGrid-head'></div>",k="<div class='cell {columnId} {cssClass}' id='{id}'><span class='label'>{value}</span></div>",s="<div class='group level{level}'><div class='group-header'><span class='open-close-indicator'>-</span>{value}</div></div>",m="<div class='row level{level}' id='{id}'></div>",p="<div class='cell {columnId} {cssClass} {spacerClass}'>{value}</div>",A="<div class='afGrid-rows'><div class='afGrid-rows-content'></div></div>",B="<div class='loading-message'>Loading...</div>";
f.fn.afGrid=function(I){I=f.extend({id:null,rows:[],columns:[],rowHover:true,onRowClick:null,onScrollToBottom:f.noop,columnWidthOverride:null,makeColumnDraggable:F,showTotalRows:true,totalRowLabelTemplate:t,loadingMessage:B},I);var G={},H=[];if(!(I.id&&/^[a-zA-Z0-9]*$/.test(I.id))){throw"You need to provide id for the afGrid and ensure that the id don't have any special characters in it.";
}return this.each(function(){var R=f(this);w(I);j(I);var T={},M,O=i(I,T),S=O.$rowsMainContainer,Q=I.rows.length,K;if(R.hasClass("afGrid-initialized")){S=R.find(".afGrid-rows").empty().append(S.children());O.$rowsMainContainer=S;M=R.find(".afGrid-head");}else{R.trigger(f.afGrid.destroy);M=C(R,I).wrap(x).parent();
R.addClass("afGrid").empty().append(M.add(S));if(I.showTotalRows){R.append(I.totalRowLabelTemplate.supplant({totalRows:"",loadedRows:""}));}R.append(I.loadingMessage);S.bind("scroll.afGrid",function(){D(M,S,I);R.data("lastScrollPos",S[0].scrollLeft);});R.unbind(f.afGrid.hideLoading).bind(f.afGrid.hideLoading,function(){R.find(".loading-message").hide();
});R.unbind(f.afGrid.showLoading).bind(f.afGrid.showLoading,function(){R.find(".loading-message").show();});}N();if(S&&S.length){S[0].scrollLeft=R.data("lastScrollPos");}function P(){r(G,I);if(f.draggable){R.find(".afGrid-heading .cell").draggable("destroy");}M.undelegate().unbind().empty().remove();
M=null;O=null;S.undelegate().unbind().remove();S=null;q(R);R.unbind(f.afGrid.hideLoading).unbind(f.afGrid.showLoading).unbind(f.afGrid.adjustRowWidth).unbind(f.afGrid.destroy).unbind(f.afGrid.appendRows).undelegate(".group .group-header","click").undelegate(".afGrid-rows .row","click").undelegate(".afGrid-rows .row","mouseenter").undelegate(".afGrid-rows .row","mouseleave").empty();
R.data("afGridColumnDraggable",false);I=null;R=null;T=null;}R.unbind(f.afGrid.destroy).bind(f.afGrid.destroy,P);function L(Y,X,U){H=f.merge(H,X);Q+=X.length;b(R,I,Q);I.columnWidthOverride=U;j(I);var W=O.lastGroupInformation.$groupContainers,aa=O.lastGroupInformation.currentGroupValues,V=O.$rowsMainContainer,Z=V.find(".row:last").hasClass("even");
O.lastGroupInformation=h(I.id,X,I.columns,I.groupBy,V.find(".afGrid-rows-content"),W,aa,Z,T,K);if(R.find(".afGrid-rows")[0].scrollHeight<=R.find(".afGrid-rows").height()){I.onScrollToBottom();}}R.unbind(f.afGrid.appendRows).bind(f.afGrid.appendRows,L);function N(){var U=0;M.find(".afGrid-heading .cell:visible").each(function(){U+=f(this).outerWidth(true);
});R.find(".afGrid-rows-content").css({minHeight:1,overflow:"hidden",width:U});}R.unbind(f.afGrid.adjustRowWidth).bind(f.afGrid.adjustRowWidth,N);if(I.rowHover){R.undelegate(".afGrid-rows .row","mouseenter").undelegate(".afGrid-rows .row","mouseleave").delegate(".afGrid-rows .row","mouseenter",function(){f(this).addClass("row-hover");
}).delegate(".afGrid-rows .row","mouseleave",function(){f(this).removeClass("row-hover");});}if(I.onRowClick){R.undelegate(".afGrid-rows .row","click").delegate(".afGrid-rows .row","click",function(){var U=f.afGrid.getElementId(f(this).attr("id"));I.onRowClick(T[U].orig||T[U],f(this));});}b(R,I,Q);var J={getColumnElementById:d};
f.each(f.afGrid.plugin,function(U,V){if(R.hasClass("afGrid-initialized")){G[U]=y[I.id][U];if(G[U].update){G[U].update(T);}}else{y[I.id]=y[I.id]||{};y[I.id][U]=G[U]=V(R,I,T);G[U].load(J);}});R.addClass("afGrid-initialized");R.trigger(f.afGrid.renderingComplete);});};function r(G,H){f.each(G,function(I,J){if(J.destroy){J.destroy();
}});delete y[H.id];}function D(G,I,H){var J=I[0];G.css({marginLeft:-1*J.scrollLeft});clearTimeout(l);l=setTimeout(function(){var K=(J.scrollHeight-I.scrollTop()),L=I.height();if((K<=(L-17))||(K<=(L))){H.onScrollToBottom();}},100);}function b(H,G,I){if(G.showTotalRows){H.find(".total-row-count").replaceWith(G.totalRowLabelTemplate.supplant({totalRows:G.totalRows,loadedRows:I}));
}}function j(G){if(G.columnWidthOverride){f.each(G.columnWidthOverride,function(I,H){if(G.columnsHashMap[I]){G.columns[G.columnsHashMap[I]].width=H;}});}}function w(G){G.columnsHashMap={};f.each(G.columns,function(H,I){G.columnsHashMap[I.id]=H;});}function d(H,G){return f("#"+G.id+"Col_"+H);}function F(G){if(!G.data("afGridColumnDraggable")){if(f.fn.draggable){G.find(".afGrid-heading .cell").draggable({helper:function(H){return E(H,G.attr("class"));
},revert:false,cancel:".resize-handle",appendTo:"body",refreshPositions:true,cursorAt:{top:0,left:0}});}G.data("afGridColumnDraggable",true);}}function q(G){if(f.fn.draggable){G.find(".afGrid-heading .cell").draggable("destroy");}G.removeData("afGridColumnDraggable");}function E(H,G){return f(H.currentTarget).clone(false).wrap(c).parent().wrap(g.supplant({cssClass:G})).parent().css("width","auto");
}function C(H,G){return v(H,G.columns,{container:c,cell:k,cellContent:function(I){return{value:I.label,id:G.id+"Col_"+I.id,cssClass:I.type||I.renderer||"",columnId:I.id};}},G.id);}function v(J,I,K,H){var G=f(K.container),L=I.length;f.each(I,function(M,O){if(O.render!==false){var N=K.cellContent(O),P;
N.cssClass=N.cssClass+(M===L-1?" last":"")+(M===0?" first":"");if(f.afGrid.renderer[O.type]&&f.afGrid.renderer[O.type].headerCell){N.value=f.afGrid.renderer[O.type].headerCell(J,O,I,H);}P=f(K.cell.supplant(N));P.css({width:O.width,display:O.isHidden?"none":""});G.append(P);}});return G;}function i(H,J){var G=f(A),I=h(H.id,H.rows,H.columns,H.groupBy,G.find(".afGrid-rows-content"),null,[],false,J);
return{$rowsMainContainer:G,lastGroupInformation:I};}function z(K,G,I){var H=G[K];var J=(I[K].type||I[K].renderer);if(J){H=f.afGrid.renderer[J].cell(H,I[K]);}return f(s.supplant({value:H,level:K}));}function e(O,I,G,L,N,J){var H,K,M;if(N===null){N=[];for(H=0,K=I.length;H<K;H+=1){N[H]=z(H,L,J);M=f(u);
if(H!==0){M.append(o(J[H-1],"","spacer"));}M.append(N[H]);O.append(M);O=N[H];}}else{for(H=G,K=I.length;H<K;H+=1){N[H]=z(H,L,J);M=f(u);if(H===0){M.append(N[H]);O.append(M);}else{M.append(o(J[H-1],"","spacer"));M.append(N[H]);N[H-1].append(M);}}}return N;}function h(L,R,N,K,P,Q,J,G,O,M){var H=K&&K.length;
var I=new Date().getTime()+Math.floor(Math.random()*100);f.each(R,function(U,X){X.id=X.id||L+"Row"+(I+U);var W=X.id,V=W?X.data:X,T=P,S;if(W){(O[W]=X);}if(H){if(Q===null){f.each(K,function(Y){J[Y]=V[Y];});Q=e(P,K,null,J,Q,N);}else{f.each(K,function(Z){var Y;if(V[Z]!==J[Z]){for(Y=Z;Y<H;Y+=1){J[Y]=V[Y];
}Q=e(P,K,Z,J,Q,N);}});}T=Q[H-1];}S=a(L,W,X,H,N);if((U+(G?1:0))%2===0){S.addClass("even");}if(U===0&&M===undefined){S.addClass("row-first");}if(M){S.css("width",M);}T.append(S);});return{$groupContainers:Q,currentGroupValues:J};}function a(K,J,R,H,N){J=R.id;var M=J?R.data:R,O=f(m.supplant({level:H,id:K+"DataRow_"+J})),P=N[H-1];
var I,L,G;if(P){O.append(o(P,""));}for(I=H,L=M.length;I<L;I+=1){G=M[I];var Q=(N[I].type||N[I].renderer);if(Q){G=f.afGrid.renderer[Q].cell(G,N[I],I,R);}O.append(o(N[I],G,null,I===(L-1)));}return O;}function o(G,K,J,I){var H=f(p.supplant({value:K||"&nbsp;",columnId:G.id,cssClass:(G.type||G.renderer||"")+(I?" last":""),spacerClass:J||""}));
H.css({"width":G.width,"display":G.isHidden?"none":""});H.css("width",G.width);return H;}}(jQuery));if(!Array.indexOf){Array.prototype.indexOf=function(c,d){var b,a;for(b=(d||0),a=this.length;b<a;b+=1){if(this[b]===c){return b;}}return -1;};}if(!String.hasOwnProperty("supplant")){String.prototype.supplant=function(a,b){return this.replace(/\{([^{}]*)\}/g,function(c,e){var f=b?e.replace(b+".",""):e,d=a[f];
return d!==undefined?d:c;});};}(function(f){var t=100;AF.Grid.DataStore=function(R,S){var F,T,B,C,N;function K(X,Y){U("fetchRows",X,Y);}function M(X,Y){U("filter",X,Y);}function O(X,Y){U("groupBy",X,Y);}function P(X,Y){U("sortBy",X,Y);}function G(X,Y){U("reorderColumn",X,Y);}function I(X,Y){U("load",X,Y);
}function Q(){if(T){return{columns:(function(){var X=f.extend([],T.columns);f.each(X,function(Z,Y){delete Y.filterData;delete Y.filterType;});return X;}()),filters:(function(){var X=f.extend([],T.filters);f.each(X,function(Y,Z){Z.type=Z.type||Z.filterType;Z.value=Z.value||Z.filterData;delete Z.filterData;
delete Z.filterType;});return X;}()),state:f.extend({},T.state)};}return null;}function E(X,Y){F=false;I(X,Y);}function W(){F=null;T=null;B=null;C=null;N=null;}function U(Y,X,Z){X=X||{};if(!F){R[Y](V(X),function(aa){L(Y,X,Z,aa);});}else{H(Y,X,Z);}}function V(Y){var Z={};if(!f.isEmptyObject(Y)){Z.state=f.extend({},Y);
}if(Y.pageSize){Z.pageSize=Y.pageSize;}if(Z.state&&Z.state.columnWidthOverride){var X=[];f.each(Z.state.columnWidthOverride,function(aa,ab){X.push({id:aa,width:ab});});Z.state.columnWidthOverride=X;}if(Z.state&&Z.state.pageSize){delete Z.state.pageSize;}return Z;}function D(Y){r(Y.columns,Y.filters);
if(Y.state){if(Y.state.columnWidthOverride){var X={};f.each(Y.state.columnWidthOverride,function(Z,aa){X[aa.id]=aa.width;});Y.state.columnWidthOverride=X;}if(Y.state.hiddenColumns){f.each(Y.state.hiddenColumns,function(Z,aa){q(aa,Y.columns).column.isHidden=true;});}return f.extend(Y,Y.state);}return Y;
}function J(X,Y){var aa=[];var Z=[];f.each(Y,function(ab,ac){if(X.indexOf(ac.id)>-1){aa[X.indexOf(ac.id)]=ac.id;}else{Z.push(ac.id);}});return aa.concat(Z);}function H(ac,ab,ae){var Z,Y;Z=v(T.rows,T.columns);C=f.extend(true,[],T.columns);B=l(f.extend(true,[],Z),ab.filterBy,C,T.filters,false);var aa;if(ab.columnOrder&&ab.columnOrder.length){aa=ab.columnOrder;
}else{if(T.columnOrder&&T.columnOrder.length){aa=T.columnOrder;}else{aa=k(T.columns);}}aa=J(aa,T.columns);Y=x(aa,C,B);C=Y.columns;B=Y.rows;var X=f.extend({},T.state,ab);z(X,C,B);var ad=f.extend({},ab);if(ac==="fetchRows"){ad={rows:A(ab.pageOffset-1,ab.pageSize,B)};}else{ad=f.extend({},y(t,C,B),ad,{filters:N.filters,isGridSortable:N.isGridSortable,isGridGroupable:N.isGridGroupable,isGridFilterable:N.isGridFilterable,isGridColumnReorderable:N.isGridColumnReorderable});
}setTimeout(function(){ae(ad);},50);}function L(ac,ab,ae,ad){ad=D(ad);var Y,X;N=ad;if(ac==="fetchRows"){Y=v(ad.rows,T.columns);var aa=g(n(ab.columnOrder,C),Y);T.rows=B.concat(aa);B=T.rows;if(S&&(T.totalRows===T.rows.length&&p(T.filterBy))){F=true;}ae({rows:aa});}else{T=ad;C=f.extend(true,[],T.columns);
Y=v(T.rows,C);var Z;if(T.columnOrder&&T.columnOrder.length){Z=T.columnOrder;}else{Z=k(C);}Z=J(Z,T.columns);X=x(Z,C,Y);C=X.columns;B=X.rows;T.rows=X.rows;T.columns=X.columns;if(S&&(T.totalRows<=T.pageSize&&p(T.filterBy))){F=true;U("load",ab,ae);return;}ae(T);}}return{refresh:E,load:I,fetchRows:K,filter:M,groupBy:O,sortBy:P,reorderColumn:G,destroy:W,getCurrentMetaData:Q};
};function p(B){return B===null||B===undefined||B.length===0;}function r(B,C){if(B&&C){f.each(B,function(D,E){var F=e(E,C);E.filterType=F.type;E.filterData=F.value;});}}function e(B,C){var D={};f.each(C,function(E,F){if(F.id===B.id){D={type:F.type||F.filterType,value:F.value||F.filterData};return false;
}return true;});return D;}function o(B){return B&&B[0]&&(!B[0].data&&!f.isArray(B[0]));}function v(C,B){if(o(C)){return d(C,k(B));}else{return C;}}function d(E,D){var C=[];var F,B;for(F=0,B=E.length;F<B;F++){C[C.length]={id:E[F].id||null,orig:E[F],data:c(E[F],D)};}return C;}function c(D,B){var C=[];f.each(B,function(E,F){C[C.length]=D[F];
});return C;}function k(C){var B=[];f.each(C,function(D,E){B[B.length]=E.id;});return B;}function b(H,M,G,I){if(I){var K=x(k(M),M,G);M=K.columns;G=K.rows;}var B=H.groupBy&&H.groupBy.length?f.map(H.groupBy,function(O){return O.id;}):[];var J=H.sortBy&&H.sortBy.length?H.sortBy[0].id:null;var L=H.sortBy&&H.sortBy.length?H.sortBy[0].direction:null;
var D=f.merge([],B||[]),C=[],N=[];var E,F;if(I){if(J){if(D.indexOf(J)<0){D.push(J);}}C=f.map(D,function(O){return q(O,M).index;});N=f.map(D,function(O){return(O===J)?(L==="desc"?-1:1):1;});}else{for(E=0,F=D.length;E<F;E++){C.push(E);N.push(D[E]===J?(L==="desc"?-1:1):1);}if(J){if(D.indexOf(J)<0){C[C.length]=q(J,M).index;
N[N.length]=(L==="desc"?-1:1);}}}w(G,C,N,M);}function h(D,B){var C=B[D],E=C.type||C.renderer;if(E){E=f.afGrid.renderer[E];}if(E&&E.comparator){return E.comparator;}return s;}function s(C,B){return C===B?0:(C<B?-1:1);}function w(F,B,G,D){if(!(B&&B.length>0)){return;}var E=[];f.each(B,function(I,J){E[J]=h(J,D);
});var H=B.length;F.sort(C);function C(L,K,O){O=(arguments.length===2)?0:O;var J=L.data,I=K.data,M=B[O],N=m(M,J,I,E[M]);if(H===1||M===undefined||N!==0){return N*G[O];}if(O<H-1){return C(L,K,++O);}return 0;}}function m(F,D,B,G){var E=D[F];var C=B[F];return G(E,C);}function A(G,D,C){var E=[],B=0,F;for(F=G;
F<G+D;F++){if(!C[F]){break;}E[B++]=C[F];}return E;}function y(B,C,D){return{columns:C,rows:A(0,B,D),totalRows:D.length,pageSize:B};}function q(D,B){var E=-1,C=f.grep(B,function(G,F){if(G.id===D){E=F;return true;}return false;})[0];return{column:C,index:E};}function l(B,J,H,E,D){var I,F=[];if(J){I=f.map(J,function(L){return L.id;
});f.each(J,function(L,M){F.push(M);});}if(D){r(H,E);B=v(B,H);}var K=[],C;var G=[];if(I){C=f.map(I,function(N){var M=q(N,H);var L=M.column;G[M.index]={column:L,filterFunc:(f.afGrid.filter[L.filterType]&&f.afGrid.filter[L.filterType].filter)||a};return(M.index);});f.each(B,function(M,N){var L=true;f.each(C,function(P,O){if(!G[O].filterFunc(F[P],N.data[O])){L=false;
}});if(L){K.push(N);}});}else{K=B;}return K;}function a(C,D){var B=true;var E=C.value;if(f.isArray(E)){if(E.indexOf(D)<0){B=false;}}else{if((String(D)).toLowerCase().indexOf((String(E)).toLowerCase())<0){B=false;}}return B;}function g(B,C){f.each(C,function(E,G){var F=[];var H,D;for(H=0,D=G.data.length;
H<D;H++){F[H]=G.data[B[H]];}G.data=F;});return C;}function n(B,C){return f.map(B,function(D){return(q(D,C).index);});}function u(B,C){return f.map(B,function(D){return(q(D,C).column);});}function j(B,C,D){g(n(B,C),D);C=u(B,C);return{columns:C,rows:D,columnOrder:B};}function x(C,B,D){return j(C,B,D);}function i(B){return(B.groupBy&&B.groupBy.length)||(B.sortBy&&B.sortBy.length);
}function z(D,B,C){if(i(D)){b(D,B,C);}}AF.Grid.DataStore.utils={getFilteredRows:l,sortData:b,getRows:A};}(jQuery));(function(e){var c=100;var b={LEFT:"LEFT",RIGHT:"RIGHT"};e.afGrid=e.extend(true,e.afGrid,{plugin:{columnReorder:function(q,r){var m,l,g,j;var n=b.RIGHT;r=e.extend({isGridColumnReorderable:true,onColumnReorder:e.noop},r);
function k(s,t){d(s,t,r,q,n);}function i(s){f(e(s.target),n);}function p(){if(!r.isGridColumnReorderable){return;}l=q.offset().left;m=q.width();g=q.find(".afGrid-rows");j=q.find(".afGrid-heading");var s=".afGrid-heading .cell";var t,u;q.delegate(s,"dragstop",function(){q.undelegate(".afGrid-heading .cell","mouseout.reorder");
q.undelegate(".afGrid-heading .cell","mousemove.reorder");window.clearInterval(t);});q.delegate(s,"dragstart",function(w){window.clearInterval(t);var v=w.currentTarget;q.delegate(".afGrid-heading .cell","mousemove.reorder",function(x){if(x.currentTarget.id!==v.id){n=(x.clientX<(e(this).offset().left+(e(this).width()/2)))?b.LEFT:b.RIGHT;
f(e(this),n);}});q.delegate(".afGrid-heading .cell","mouseout.reorder",function(){e(this).removeClass("reorder-left reorder-right");});});q.delegate(s,"drag",function(v){if(v.clientX>(l-c)&&v.clientX<(l+c)){window.clearInterval(t);u=g[0].scrollLeft;t=window.setInterval(function(){if(g[0].scrollLeft>0){g[0].scrollLeft-=10;
}},50);}else{if(v.clientX>(l+m-c)&&v.clientX<(l+m+c)){window.clearInterval(t);u=g[0].scrollLeft+j.width()+100;t=window.setInterval(function(){if(g[0].scrollLeft<u){g[0].scrollLeft+=10;}},50);}else{window.clearInterval(t);}}});if(e.fn.droppable){q.find(s).droppable({drop:k,over:i,out:a,accept:s,tolerance:"pointer"});
}r.makeColumnDraggable(q);}function h(){l=q.offset().left;m=q.width();g=q.find(".afGrid-rows");j=q.find(".afGrid-heading");}function o(){r=null;if(e.fn.droppable){q.find(".afGrid-heading .cell").droppable("destroy");}q.undelegate(".afGrid-heading .cell","drag");q.undelegate(".afGrid-heading .cell","dragstop");
g=null;j=null;}return{load:p,update:h,destroy:o};}}});function d(g,j,o,m,l){var i=e(g.target);i.removeClass("reorder-left reorder-right");var k=e.afGrid.getElementId(j.draggable.attr("id")),h=e.afGrid.getElementId(i.attr("id")),n=[];e.each(o.columns,function(p,q){if(q.id!==k){n.push(q.id);}if(q.id===h){if(l===b.RIGHT){n.push(k);
}else{n.splice((n.length-1),0,k);}}});m.removeClass("afGrid-initialized");o.onColumnReorder(n);}function f(h,g){h.removeClass("reorder-left reorder-right").addClass(g===b.LEFT?"reorder-left":"reorder-right");}function a(g){e(g.target).removeClass("reorder-left reorder-right");}}(jQuery));(function(a){a.afGrid=a.extend(true,a.afGrid,{plugin:{columnResize:function(e,b){b=a.extend({isGridColumnResizable:true,onColumnResize:a.noop,minColumnWidth:30,maxColumnWidth:700},b);
var d=b.columns;function g(h){if(!b.isGridColumnResizable){return;}a.each(b.columns,function(j,k){if(k.isResizable!==false){h.getColumnElementById(k.id,b).append("<span class='resize-handle'></span>").addClass("resizable-column");}});var i=e.find(".afGrid-heading");f();i.delegate(".resize-handle","click",function(){return false;
});i.delegate(".resize-handle","mousedown",function(){var m=a(this).parents(".cell").eq(0);var k=a(this);var l=a.afGrid.getElementId(m.attr("id")),p,o,n,j;n=a("<div class='resize-guide'></div>");n.css({height:e.height(),top:0,left:k.offset().left-e.offset().left+k.width()});e.append(n);o=m.width();p=event.screenX;
a(document).bind("mousemove.afGridResizeGuide",function(q){j=o+(q.screenX-p);if(j<=b.minColumnWidth){j=b.minColumnWidth;}else{if(j>=b.maxColumnWidth){j=b.maxColumnWidth;}}n.css({left:k.offset().left-e.offset().left+k.width()});m.width(j);b.columns[b.columnsHashMap[l]].width=j;return false;});a(document).bind("mouseup.afGridResizeGuide",function(){a(document).unbind("mousemove.afGridResizeGuide mouseup.afGridResizeGuide");
n.unbind();n.remove();p=null;e.find(".afGrid-rows ."+l).width(j);e.find(".afGrid-filter ."+l).width(j);b.onColumnResize(l,o,j);e.trigger(a.afGrid.adjustRowWidth);return false;});return false;});}function f(){var h=e.find(".afGrid-heading");h.undelegate(".resize-handle","mousedown");h.undelegate(".resize-handle","click");
}function c(){f();d=null;b=null;}return{load:g,destroy:c};}}});}(jQuery));(function(g){var e={};g.afGrid=g.extend(true,g.afGrid,{plugin:{filters:function(k,i){i=g.extend({isGridFilterable:true,filterBy:null,onFilter:g.noop},i);var h;function n(){if(h){var o=[];b(h,function(r,q){var p=g.afGrid.filter[q].getValue(r);
if(p){p.id=g.afGrid.getElementId(r.attr("id"));p.valueType=p.valueType||q;o.push(p);}});if(o&&o.length){h.addClass("filtered");}else{h.removeClass("filtered");}k.find(".afGrid-rows")[0].scrollTop=0;i.onFilter(o);}}function m(){return h;}function l(){if(!i.isGridFilterable||!(i.filters&&i.filters.length)){return;
}h=f(i);e[i.id]=h;b(h,function(p,o){p.addClass("afGrid-filter-control");g.afGrid.filter[o].init(p,n,i.id,k);});if(i.filterBy&&i.filterBy.length){g.each(i.filterBy,function(o,p){var q=h.find("#"+i.id+"Filter_"+p.id);if(q.length){g.afGrid.filter[a(q)].filterBy(q,p);}});h.addClass("filtered");}else{h.removeClass("filtered");
}k.find(".afGrid-head").append(m());}function j(){delete e[i.id];if(h){b(h,function(p,o){g.afGrid.filter[o].destroy(p,k);});h.empty();h=null;}i=null;}return{load:l,destroy:j};}}});function f(h){return c(h.columns,{container:"<div class='afGrid-filter'></div>",cell:"<span class='cell {columnId} {cssClass}' id='{id}'>{value}</span>",cellContent:function(i){return{value:d(i.filterType,i.filterData,h.id+"Filter_"+i.id),id:h.id+"ColFilter_"+i.id,columnId:i.id,cssClass:""};
}});}function c(i,j){var h=g(j.container),k=i.length;g.each(i,function(l,n){if(n.render!==false){var m=j.cellContent(n),o;m.cssClass=m.cssClass+(l===k-1?" last":"")+(l===0?" first":"");o=g(j.cell.supplant(m));o.css({width:n.width,display:n.isHidden?"none":""});h.append(o);}});return h;}function d(h,i,j){if(h===undefined){return"";
}else{if(g.afGrid.filter[h]){return g.afGrid.filter[h].render(j,i).supplant({filterIdentifier:h+"-filter"});}}throw"Unknown filter type defined in column data.";}function b(h,i){if(g.afGrid.filter){g.each(g.afGrid.filter,function(k){var j=h.find("."+k+"-filter");j.each(function(){i(g(this),k);});});}}function a(i){var h="";
g.each(g.afGrid.filter,function(j){if(i.hasClass(j+"-filter")){h=j;return false;}return true;});return h;}}(jQuery));(function(d){var b={};d.afGrid=d.extend(true,d.afGrid,{plugin:{groups:function(n,o){o=d.extend({id:o.id,isGridGroupable:true,onGroupChange:d.noop,onGroupReorder:d.noop,groupsPlaceHolder:null,groupBy:null},o);
var k,j;function f(r,t){var s=t.length,u,q;if(s){k.find(".empty-message").hide();u=k.find(".groups").show();u.empty();q=d();d.each(t,function(v,x){var w=d("<span id='{id}' class='cell'><span class='arrow'><span class='label'><a class='remove' href='#'>x</a> {label}</span></span></span>".supplant({label:r[o.columnsHashMap[x]].label,id:o.id+"GroupBy_"+x}));
q=q.add(w);if(v===0){w.addClass("first");}if(v===s-1){w.addClass("last");}});u.append(q);}else{k.find(".empty-message").show();k.find(".groups").hide();}j=t;}function g(r){var q=d.grep(j,function(s){return s!==r;});n.removeClass("afGrid-initialized");o.onGroupChange(q);}function p(q,s){var r=d.afGrid.getElementId(s.draggable.attr("id"));
if(j&&j.indexOf(r)>-1){return false;}j.push(r);setTimeout(function(){n.removeClass("afGrid-initialized");o.onGroupChange(j);},10);return true;}function h(r){var s=d(r.currentTarget),q=!s.data("state");s.data("state",q);s.find(".open-close-indicator").html(q?"+":"-");s.removeClass("open close").addClass(q?"close":"open");
s.parents(".group").eq(0)[q?"addClass":"removeClass"]("group-closed");setTimeout(function(){n.find(".group-data").css({zoom:1}).css({zoom:0});if(n.find(".afGrid-rows")[0].scrollHeight<=n.find(".afGrid-rows").height()){o.onScrollToBottom();}},450);}function i(s,t){var u=d(s.target);u.removeClass("reorder");
var r=d.afGrid.getElementId(t.draggable.attr("id")),v=d.afGrid.getElementId(u.attr("id")),q=[];d.each(o.groupBy,function(w,x){if(x!==r){q.push(x);}if(x===v){q.push(r);}});n.removeClass("afGrid-initialized");o.onGroupReorder(q);}function m(q){if(!o.isGridGroupable){return;}d.each(o.columns,function(r,s){if(!(d.afGrid.renderer[s.type]&&d.afGrid.renderer[s.type].headerCell)){if(s.isGroupable!==false){q.getColumnElementById(s.id,o).append("<span class='groupable-indicator'></span>").addClass("groupable-column");
}}});n.undelegate(".group .group-header","click").delegate(".group .group-header","click",h);k=d(o.groupsPlaceHolder).undelegate("a.remove","click.groups").delegate("a.remove","click.groups",function(){g(d.afGrid.getElementId(d(this).parents(".cell").eq(0).attr("id")));return false;});b[o.id]=k;f(o.columns,o.groupBy);
if(d.fn.droppable){k.droppable({drop:p,accept:"#"+o.id+" .groupable-column",activeClass:"ui-state-highlight",tolerance:"touch",hoverClass:"ui-state-highlight-hover"});k.find(".cell").droppable({accept:".groups .cell",drop:i,over:a,out:c,tolerance:"pointer"});}if(d.fn.draggable){k.find(".cell").draggable({drop:p,helper:e,accept:"#"+o.id+" .groupable-column",containment:k});
}o.makeColumnDraggable(n);}function l(){if(k){if(d.fn.droppable){k.droppable("destroy");k.find(".cell").droppable("destroy");}if(d.fn.draggable){k.find(".cell").draggable("destroy");}delete b[o.id];k.undelegate("a.remove","click.groups");k.find(".groups").empty();k=null;}j=null;o=null;}return{load:m,destroy:l};
}}});function a(f){d(f.target).addClass("reorder");}function c(f){d(f.target).removeClass("reorder");}function e(f){return d(f.currentTarget).clone(false).addClass("group-helper");}}(jQuery));(function(a){a.afGrid=a.extend(true,a.afGrid,{plugin:{sortable:function(f,c){c=a.extend({isGridSortable:true,sortBy:null,onSort:a.noop},c);
var b={ASC:"asc",DESC:"desc"};function h(i){var k=a(i.currentTarget),j=a.afGrid.getElementId(i.currentTarget.id),l;f.find(".afGrid-heading .sortable-column").not(k).removeClass("asc desc").removeData("direction");l=k.data("direction");if(!l){l=b.ASC;}else{if(l===b.ASC){l=b.DESC;}else{l=b.ASC;}}k.data("direction",l);
k.removeClass("asc desc").addClass(l);c.onSort(j,l);}function g(i){if(!c.isGridSortable){return;}if(c.sortBy){var j=f.find("#"+c.id+"Col_"+c.sortBy.column);j.addClass(c.sortBy.direction);j.data("direction",c.sortBy.direction);}a.each(c.columns,function(k,l){if(a.afGrid.renderer[l.type]&&a.afGrid.renderer[l.type].headerSortArrow){var m=a.afGrid.renderer[l.type].headerSortArrow;
if(m){m(f,l,c.columns,i.getColumnElementById(l.id,c));}}else{if(l.isSortable!==false){i.getColumnElementById(l.id,c).append("<span class='sort-arrow'></span>").addClass("sortable-column");}}});e(f);f.delegate(".afGrid-heading .sortable-column","click",h).delegate(".afGrid-heading .sortable-column","mouseenter",function(){a(this).addClass("sort-hover");
}).delegate(".afGrid-heading .sortable-column","mouseleave",function(){a(this).removeClass("sort-hover");});}function e(i){i.undelegate(".afGrid-heading .sortable-column","click");i.undelegate(".afGrid-heading .sortable-column","mouseleave");i.undelegate(".afGrid-heading .sortable-column","mouseenter");
}function d(){e(f);c=null;}return{load:g,destroy:d};}}});}(jQuery));(function(b){var a={};b.afGrid=b.extend(true,b.afGrid,{plugin:{toolbar:function(f,d){d=b.extend({showToolbar:true,toolbarTemplate:"<div class='afGrid-toolbar'><a href='#' class='afGrid-reset'>Reset</a><a href='#' class='afGrid-refresh'>Refresh</a></div>",onReset:b.noop},d);
var c;function g(){if(!d.showToolbar){return;}c=b(d.toolbarTemplate);a[d.id]=c;f.prepend(c);f.undelegate(".afGrid-reset","click").delegate(".afGrid-reset","click",function(){d.onReset();return false;});f.undelegate(".afGrid-refresh","click").delegate(".afGrid-refresh","click",function(){d.onRefresh();
return false;});}function e(){delete a[d.id];if(c){f.undelegate(".afGrid-reset","click");f.undelegate(".afGrid-refresh","click");}d=null;}return{load:g,destroy:e};}}});}(jQuery));(function(a){a.statePersistToCookie=a.cookie&&{load:function(b,c){c(a.cookie(b));},save:function(b,c,d){a.cookie(b,c,{expires:100,path:"/"});
if(d){d();}}};}(jQuery));(function(b){b.afGrid.filter.DATE={render:function(d){var c="<input id='{id}' type='text' class='{filterIdentifier}' value=''/>";return c.supplant({id:d});},init:function(f,e,c,d){f.daterangepicker({onChange:function(){f.attr("title",f.val());e();},dateFormat:"dd/mm/yy"});d.find(".afGrid-rows").bind("scroll.datefilter-"+f.attr("id"),function(){b(document).trigger("click.daterangeinput");
});},filterBy:function(d,c){if(c.valueType==="SPECIFIC_DATE"){d.val(c.value);}else{d.val(c.from+" - "+c.to);}d.attr("title",d.val());},getValue:function(d){var c=d.val();if(c.indexOf(" - ")>0){var e=c.split(" - ");return e&&{valueType:"DATE_RANGE",from:e[0],to:e[1]};}return c&&{valueType:"SPECIFIC_DATE",value:d.val()};
},filter:function(j,i){var c=true;var g=/(\d{1,2})\/(\d{2})\/(\d{4})/.exec(i);var f,h,d;if(!g){g=/(\d{4})\-(\d{2})\-(\d{1,2})/.exec(i);f=g[1];d=g[3];}else{f=g[3];d=g[1];}h=g[2];var e=new Date(f,parseInt(h,10)-1,d);if(j.valueType==="SPECIFIC_DATE"){if(e.getTime()!==a(j.value).getTime()){c=false;}}else{if(!(e.getTime()>=a(j.from).getTime()&&e.getTime()<=a(j.to).getTime())){c=false;
}}return c;},destroy:function(d,c){c.find(".afGrid-rows").unbind("scroll.datefilter-"+d.attr("id"));d.daterangepicker("destroy");}};function a(d){var c=/(\d{1,2})\/(\d{1,2})\/(\d{4})/.exec(d);return new Date(c[3],c[2]-1,c[1]);}}(jQuery));(function(b){var a={};var c=600;b.afGrid.filter.FREE_TEXT={render:function(e){var d="<input id='{id}' type='text' class='{filterIdentifier}'/>";
return d.supplant({id:e});},init:function(g,f,d){var e=null;g.bind("change.filter",f).bind("keyup.filter",function(h){var i=b(h.target);if(a[d]&&a[d][i.attr("id")]!==i.val()&&a[d][i.attr("id")]!==undefined){window.clearTimeout(e);e=window.setTimeout(function(){f.call(i[0]);e=null;},c);}a[d]=a[d]||{};
a[d][i.attr("id")]=i.val();});},filterBy:function(e,d){e.val(d.value);},getValue:function(e){var d=e.val();return d&&{value:d};},destroy:function(d){d.unbind("change.filter").unbind("keyup.filter");}};}(jQuery));(function(b){b.afGrid.filter.MULTI_SELECT={render:function(f,e){var c,d;c="<select id='{id}' multiple='true' class='{filterIdentifier}'>{options}</select>";
d=[];b.each(e,function(g,h){d[d.length]="<option value='{value}'>{value}</option>".supplant({value:h});});return c.supplant({id:f,options:d.join("")});},init:function(f,e,c,d){if(b.fn.multiselect){f.multiselect({overrideWidth:"100%",overrideMenuWidth:"200px",close:g,click:a,checkAll:a,uncheckAll:a,noneSelectedText:"&nbsp;",selectedText:"Filtered",selectedList:1});
}function g(h){if(b(h.target).hasClass("multi-select-changed")){e.apply(h.target,arguments);}}d.find(".afGrid-rows").bind("scroll.multiselect-"+f.attr("id"),function(){b(document).trigger("mousedown.multiselect");});},filterBy:function(e,c){var d=c.values;e.find("option").each(function(){if(d.indexOf(b(this).val())>-1){b(this).attr("selected","true");
}});e.multiselect("refresh");},getValue:function(d){var c=d.multiselect("getChecked").map(function(){return this.value;}).get();return c&&c.length&&{values:c};},filter:function(e,d){var c=true;if(e&&e.values){if(e.values.indexOf(d)<0){c=false;}}return c;},destroy:function(d,c){if(b.fn.multiselect){d.multiselect("destroy");
}c.find(".afGrid-rows").unbind("scroll.multiselect-"+d.attr("id"));}};function a(c){b(c.target).addClass("multi-select-changed");}}(jQuery));(function(a){a.afGrid.filter.SIMPLE_DATE={render:function(c){var b="<input id='{id}' type='text' class='{filterIdentifier}' value=''/>";return b.supplant({id:c});
},init:function(c,b){c.datepicker({onClose:b,dateFormat:"dd-M-yy"});},filterBy:function(c,b){c.datepicker("setDate",b.value);},getValue:function(c){var b=c.val();return b&&{value:b};},destroy:function(b){b.datepicker("destroy");}};}(jQuery));(function(b){var a={};b.afGrid=b.extend(true,b.afGrid,{plugin:{THEME_SWITCHER:function(e,c){function f(){var g=b("."+c.id+"-afGrid-switch-theme");
g.delegate(".theme","click",function(){var k=b(this).attr("href").replace("#",""),j=c.id;var h=b("#"+j);var i=b("."+j+"-afGrid-group-by");if(a[j]){h.removeClass("afGrid-"+a[j]);i.removeClass("afGrid-group-by-"+a[j]);}a[j]=k;h.addClass("afGrid-"+a[j]);i.addClass("afGrid-group-by-"+a[j]);return false;});
}function d(){b("."+c.id+"-afGrid-switch-theme").undelegate(".theme","click");c=null;}return{load:f,destroy:d};}}});}(jQuery));(function(b){b.afGrid.renderer.DATE={cell:function(c){return"<span class='date'>{date}</span>".supplant({date:c});},comparator:function(d,c){return a(d)-a(c);}};function a(d){var c=/(\d{1,2})\/(\d{2})\/(\d{4})/.exec(d);
return c?new Date(c[3],parseInt(c[2],10)-1,c[1]).getTime():d;}}(jQuery));(function(a){a.afGrid.renderer.LABEL_BUTTON={cell:function(b){return"<input type='button' class='button' value='{value}'><input type='hidden' value='{actualValue}' class='dataValue'>".supplant({value:"Show",actualValue:b});}};}(jQuery));
(function(a){a.afGrid.renderer.NUMERIC={cell:function(b){return b;},comparator:function(c,b){c=Number(String(c).replace(/,/g,""));b=Number(String(b).replace(/,/g,""));return c-b;}};}(jQuery));(function(b){var a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];b.afGrid.renderer.SYSTEM_DATE={cell:function(d){var c=d.split("-");
var e=d!=="-"?[c[2],"-",a[(+c[1])-1],"-",c[0]].join(""):"-";return"<span class='date'>{date}</span>".supplant({date:e});}};}(jQuery));